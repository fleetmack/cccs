with dups as
(select SYSTEM_LOAD_PROCESS ,
 USER_ATTRIBUTE_05_LD ,
 USER_ATTRIBUTE_05_SD ,
 USER_ATTRIBUTE_05 ,
 USER_ATTRIBUTE_04_LD ,
 USER_ATTRIBUTE_04_SD ,
 USER_ATTRIBUTE_04 ,
 USER_ATTRIBUTE_03_LD ,
 USER_ATTRIBUTE_03_SD ,
 USER_ATTRIBUTE_03 ,
 USER_ATTRIBUTE_02_LD ,
 USER_ATTRIBUTE_02_SD ,
 USER_ATTRIBUTE_02 ,
 USER_ATTRIBUTE_01_LD ,
 USER_ATTRIBUTE_01_SD ,
 USER_ATTRIBUTE_01 ,
 COURSE_FAILED_IND_LD ,
 COURSE_FAILED_IND_SD ,
 COURSE_FAILED_IND ,
 COURSE_WITHDRAWN_IND_LD ,
 COURSE_WITHDRAWN_IND_SD ,
 COURSE_WITHDRAWN_IND ,
 COURSE_DROPPED_IND_LD ,
 COURSE_DROPPED_IND_SD ,
 COURSE_DROPPED_IND ,
 COURSE_PASSED_IND_LD, 
 COURSE_PASSED_IND_SD ,
 COURSE_PASSED_IND ,
 COURSE_ATTEMPTED_IND_LD ,
 COURSE_ATTEMPTED_IND_SD ,
 COURSE_ATTEMPTED_IND ,
 REGISTER_CENSUS_DATE2_IND_LD ,
 REGISTER_CENSUS_DATE2_IND_SD ,
 REGISTER_CENSUS_DATE2_IND ,
 REGISTER_CENSUS_DATE1_IND_LD ,
 REGISTER_CENSUS_DATE1_IND_SD ,
 REGISTER_CENSUS_DATE1_IND ,
 COURSE_REGISTER_IND_LD ,
 COURSE_REGISTER_IND_SD ,
 COURSE_REGISTER_IND ,
 REGISTRATION_OVERRIDE_IND_LD ,
 REGISTRATION_OVERRIDE_IND_SD ,
 REGISTRATION_OVERRIDE_IND ,
 REGISTRATION_STATUS_LD ,
 REGISTRATION_STATUS_SD ,
 REGISTRATION_STATUS ,
 GRADE_TYPE_LD ,
 GRADE_TYPE_SD ,
 GRADE_TYPE ,
 FINAL_GRADE
 from wdt_registration
 group by SYSTEM_LOAD_PROCESS ,
 USER_ATTRIBUTE_05_LD ,
 USER_ATTRIBUTE_05_SD ,
 USER_ATTRIBUTE_05 ,
 USER_ATTRIBUTE_04_LD ,
 USER_ATTRIBUTE_04_SD ,
 USER_ATTRIBUTE_04 ,
 USER_ATTRIBUTE_03_LD ,
 USER_ATTRIBUTE_03_SD ,
 USER_ATTRIBUTE_03 ,
 USER_ATTRIBUTE_02_LD ,
 USER_ATTRIBUTE_02_SD ,
 USER_ATTRIBUTE_02 ,
 USER_ATTRIBUTE_01_LD ,
 USER_ATTRIBUTE_01_SD ,
 USER_ATTRIBUTE_01 ,
 COURSE_FAILED_IND_LD ,
 COURSE_FAILED_IND_SD ,
 COURSE_FAILED_IND ,
 COURSE_WITHDRAWN_IND_LD ,
 COURSE_WITHDRAWN_IND_SD ,
 COURSE_WITHDRAWN_IND ,
 COURSE_DROPPED_IND_LD ,
 COURSE_DROPPED_IND_SD ,
 COURSE_DROPPED_IND ,
 COURSE_PASSED_IND_LD, 
 COURSE_PASSED_IND_SD ,
 COURSE_PASSED_IND ,
 COURSE_ATTEMPTED_IND_LD ,
 COURSE_ATTEMPTED_IND_SD ,
 COURSE_ATTEMPTED_IND ,
 REGISTER_CENSUS_DATE2_IND_LD ,
 REGISTER_CENSUS_DATE2_IND_SD ,
 REGISTER_CENSUS_DATE2_IND ,
 REGISTER_CENSUS_DATE1_IND_LD ,
 REGISTER_CENSUS_DATE1_IND_SD ,
 REGISTER_CENSUS_DATE1_IND ,
 COURSE_REGISTER_IND_LD ,
 COURSE_REGISTER_IND_SD ,
 COURSE_REGISTER_IND ,
 REGISTRATION_OVERRIDE_IND_LD ,
 REGISTRATION_OVERRIDE_IND_SD ,
 REGISTRATION_OVERRIDE_IND ,
 REGISTRATION_STATUS_LD ,
 REGISTRATION_STATUS_SD ,
 REGISTRATION_STATUS ,
 GRADE_TYPE_LD ,
 GRADE_TYPE_SD ,
 GRADE_TYPE ,
 FINAL_GRADE
 having count(*) > 1),
 
 dups2 as
(
select r.SYSTEM_LOAD_PROCESS ,
 r.USER_ATTRIBUTE_05_LD ,
 r.USER_ATTRIBUTE_05_SD ,
 r.USER_ATTRIBUTE_05 ,
 r.USER_ATTRIBUTE_04_LD ,
 r.USER_ATTRIBUTE_04_SD ,
 r.USER_ATTRIBUTE_04 ,
 r.USER_ATTRIBUTE_03_LD ,
 r.USER_ATTRIBUTE_03_SD ,
 r.USER_ATTRIBUTE_03 ,
 r.USER_ATTRIBUTE_02_LD ,
 r.USER_ATTRIBUTE_02_SD ,
 r.USER_ATTRIBUTE_02 ,
 r.USER_ATTRIBUTE_01_LD ,
 r.USER_ATTRIBUTE_01_SD ,
 r.USER_ATTRIBUTE_01 ,
 r.COURSE_FAILED_IND_LD ,
 r.COURSE_FAILED_IND_SD ,
 r.COURSE_FAILED_IND ,
 r.COURSE_WITHDRAWN_IND_LD ,
 r.COURSE_WITHDRAWN_IND_SD ,
 r.COURSE_WITHDRAWN_IND ,
 r.COURSE_DROPPED_IND_LD ,
 r.COURSE_DROPPED_IND_SD ,
 r.COURSE_DROPPED_IND ,
 r.COURSE_PASSED_IND_LD, 
 r.COURSE_PASSED_IND_SD ,
 r.COURSE_PASSED_IND ,
 r.COURSE_ATTEMPTED_IND_LD ,
 r.COURSE_ATTEMPTED_IND_SD ,
 r.COURSE_ATTEMPTED_IND ,
 r.REGISTER_CENSUS_DATE2_IND_LD ,
 r.REGISTER_CENSUS_DATE2_IND_SD ,
 r.REGISTER_CENSUS_DATE2_IND ,
 r.REGISTER_CENSUS_DATE1_IND_LD ,
 r.REGISTER_CENSUS_DATE1_IND_SD ,
 r.REGISTER_CENSUS_DATE1_IND ,
 r.COURSE_REGISTER_IND_LD ,
 r.COURSE_REGISTER_IND_SD ,
 r.COURSE_REGISTER_IND ,
 r.REGISTRATION_OVERRIDE_IND_LD ,
 r.REGISTRATION_OVERRIDE_IND_SD ,
 r.REGISTRATION_OVERRIDE_IND ,
 r.REGISTRATION_STATUS_LD ,
 r.REGISTRATION_STATUS_SD ,
 r.REGISTRATION_STATUS ,
 r.GRADE_TYPE_LD ,
 r.GRADE_TYPE_SD ,
 r.GRADE_TYPE ,
 r.FINAL_GRADE,
 max(trunc(registration_key)) as registration_key
 
  from dups d, wdt_registration r

where 

r.SYSTEM_LOAD_PROCESS 	=	d.SYSTEM_LOAD_PROCESS 	and
r.USER_ATTRIBUTE_05_LD 	=	d.USER_ATTRIBUTE_05_LD 	and
r.USER_ATTRIBUTE_05_SD 	=	d.USER_ATTRIBUTE_05_SD 	and
r.USER_ATTRIBUTE_05 	=	d.USER_ATTRIBUTE_05 	and
r.USER_ATTRIBUTE_04_LD 	=	d.USER_ATTRIBUTE_04_LD 	and
r.USER_ATTRIBUTE_04_SD 	=	d.USER_ATTRIBUTE_04_SD 	and
r.USER_ATTRIBUTE_04 	=	d.USER_ATTRIBUTE_04 	and
r.USER_ATTRIBUTE_03_LD 	=	d.USER_ATTRIBUTE_03_LD 	and
r.USER_ATTRIBUTE_03_SD 	=	d.USER_ATTRIBUTE_03_SD 	and
r.USER_ATTRIBUTE_03 	=	d.USER_ATTRIBUTE_03 	and
r.USER_ATTRIBUTE_02_LD 	=	d.USER_ATTRIBUTE_02_LD 	and
r.USER_ATTRIBUTE_02_SD 	=	d.USER_ATTRIBUTE_02_SD 	and
r.USER_ATTRIBUTE_02 	=	d.USER_ATTRIBUTE_02 	and
r.USER_ATTRIBUTE_01_LD 	=	d.USER_ATTRIBUTE_01_LD 	and
r.USER_ATTRIBUTE_01_SD 	=	d.USER_ATTRIBUTE_01_SD 	and
r.USER_ATTRIBUTE_01 	=	d.USER_ATTRIBUTE_01 	and
r.COURSE_FAILED_IND_LD 	=	d.COURSE_FAILED_IND_LD 	and
r.COURSE_FAILED_IND_SD 	=	d.COURSE_FAILED_IND_SD 	and
r.COURSE_FAILED_IND 	=	d.COURSE_FAILED_IND 	and
r.COURSE_WITHDRAWN_IND_LD 	=	d.COURSE_WITHDRAWN_IND_LD 	and
r.COURSE_WITHDRAWN_IND_SD 	=	d.COURSE_WITHDRAWN_IND_SD 	and
r.COURSE_WITHDRAWN_IND 	=	d.COURSE_WITHDRAWN_IND 	and
r.COURSE_DROPPED_IND_LD 	=	d.COURSE_DROPPED_IND_LD 	and
r.COURSE_DROPPED_IND_SD 	=	d.COURSE_DROPPED_IND_SD 	and
r.COURSE_DROPPED_IND 	=	d.COURSE_DROPPED_IND 	and
r.COURSE_PASSED_IND_LD 	=	d.COURSE_PASSED_IND_LD 	and
r.COURSE_PASSED_IND_SD 	=	d.COURSE_PASSED_IND_SD 	and
r.COURSE_PASSED_IND 	=	d.COURSE_PASSED_IND 	and
r.COURSE_ATTEMPTED_IND_LD 	=	d.COURSE_ATTEMPTED_IND_LD 	and
r.COURSE_ATTEMPTED_IND_SD 	=	d.COURSE_ATTEMPTED_IND_SD 	and
r.COURSE_ATTEMPTED_IND 	=	d.COURSE_ATTEMPTED_IND 	and
r.REGISTER_CENSUS_DATE2_IND_LD 	=	d.REGISTER_CENSUS_DATE2_IND_LD 	and
r.REGISTER_CENSUS_DATE2_IND_SD 	=	d.REGISTER_CENSUS_DATE2_IND_SD 	and
r.REGISTER_CENSUS_DATE2_IND 	=	d.REGISTER_CENSUS_DATE2_IND 	and
r.REGISTER_CENSUS_DATE1_IND_LD 	=	d.REGISTER_CENSUS_DATE1_IND_LD 	and
r.REGISTER_CENSUS_DATE1_IND_SD 	=	d.REGISTER_CENSUS_DATE1_IND_SD 	and
r.REGISTER_CENSUS_DATE1_IND 	=	d.REGISTER_CENSUS_DATE1_IND 	and
r.COURSE_REGISTER_IND_LD 	=	d.COURSE_REGISTER_IND_LD 	and
r.COURSE_REGISTER_IND_SD 	=	d.COURSE_REGISTER_IND_SD 	and
r.COURSE_REGISTER_IND 	=	d.COURSE_REGISTER_IND 	and
r.REGISTRATION_OVERRIDE_IND_LD 	=	d.REGISTRATION_OVERRIDE_IND_LD 	and
r.REGISTRATION_OVERRIDE_IND_SD 	=	d.REGISTRATION_OVERRIDE_IND_SD 	and
r.REGISTRATION_OVERRIDE_IND 	=	d.REGISTRATION_OVERRIDE_IND 	and
r.REGISTRATION_STATUS_LD 	=	d.REGISTRATION_STATUS_LD 	and
r.REGISTRATION_STATUS_SD 	=	d.REGISTRATION_STATUS_SD 	and
r.REGISTRATION_STATUS 	=	d.REGISTRATION_STATUS 	and
r.GRADE_TYPE_LD 	=	d.GRADE_TYPE_LD 	and
r.GRADE_TYPE_SD 	=	d.GRADE_TYPE_SD 	and
r.GRADE_TYPE 	=	d.GRADE_TYPE 	and
r.FINAL_GRADE	=	d.FINAL_GRADE	
group by 
r.SYSTEM_LOAD_PROCESS ,
 r.USER_ATTRIBUTE_05_LD ,
 r.USER_ATTRIBUTE_05_SD ,
 r.USER_ATTRIBUTE_05 ,
 r.USER_ATTRIBUTE_04_LD ,
 r.USER_ATTRIBUTE_04_SD ,
 r.USER_ATTRIBUTE_04 ,
 r.USER_ATTRIBUTE_03_LD ,
 r.USER_ATTRIBUTE_03_SD ,
 r.USER_ATTRIBUTE_03 ,
 r.USER_ATTRIBUTE_02_LD ,
 r.USER_ATTRIBUTE_02_SD ,
 r.USER_ATTRIBUTE_02 ,
 r.USER_ATTRIBUTE_01_LD ,
 r.USER_ATTRIBUTE_01_SD ,
 r.USER_ATTRIBUTE_01 ,
 r.COURSE_FAILED_IND_LD ,
 r.COURSE_FAILED_IND_SD ,
 r.COURSE_FAILED_IND ,
 r.COURSE_WITHDRAWN_IND_LD ,
 r.COURSE_WITHDRAWN_IND_SD ,
 r.COURSE_WITHDRAWN_IND ,
 r.COURSE_DROPPED_IND_LD ,
 r.COURSE_DROPPED_IND_SD ,
 r.COURSE_DROPPED_IND ,
 r.COURSE_PASSED_IND_LD, 
 r.COURSE_PASSED_IND_SD ,
 r.COURSE_PASSED_IND ,
 r.COURSE_ATTEMPTED_IND_LD ,
 r.COURSE_ATTEMPTED_IND_SD ,
 r.COURSE_ATTEMPTED_IND ,
 r.REGISTER_CENSUS_DATE2_IND_LD ,
 r.REGISTER_CENSUS_DATE2_IND_SD ,
 r.REGISTER_CENSUS_DATE2_IND ,
 r.REGISTER_CENSUS_DATE1_IND_LD ,
 r.REGISTER_CENSUS_DATE1_IND_SD ,
 r.REGISTER_CENSUS_DATE1_IND ,
 r.COURSE_REGISTER_IND_LD ,
 r.COURSE_REGISTER_IND_SD ,
 r.COURSE_REGISTER_IND ,
 r.REGISTRATION_OVERRIDE_IND_LD ,
 r.REGISTRATION_OVERRIDE_IND_SD ,
 r.REGISTRATION_OVERRIDE_IND ,
 r.REGISTRATION_STATUS_LD ,
 r.REGISTRATION_STATUS_SD ,
 r.REGISTRATION_STATUS ,
 r.GRADE_TYPE_LD ,
 r.GRADE_TYPE_SD ,
 r.GRADE_TYPE ,
 r.FINAL_GRADE)
 
 select * from dups2;
 
 
 
 
 delete from wdt_registration
 where registration_key in (8790	,
8914	,
8937	,
8946	,
8813	,
8818	,
8822	,
8823	,
8824	,
8951	,
8878	,
8884	,
8827	,
8828	,
8832	,
8836	,
8848	,
8963	,
8903	,
8936	,
8911	,
8926	,
8789	,
8955	,
8956	,
8898	,
8913	,
8821	,
8867	,
8952	,
8849	,
8858	,
8896	,
8899	,
8892	,
8934	,
8901	,
8909	,
8920	,
8921	,
8927	,
8939	,
8811	,
8888	,
8894	,
8950	,
8960	,
8967	,
8900	,
8791	,
8922	,
8928	,
8935	,
8941	,
8819	,
8820	,
8871	,
8883	,
8885	,
8834	,
8841	,
8842	,
8845	,
8957	,
8961	,
8930	,
8905	,
8906	,
8917	,
8797	,
8923	,
8907	,
8910	,
8873	,
8953	,
8954	,
8792	,
8801	,
8931	,
8938	,
8809	,
8942	,
8814	,
8825	,
8862	,
8865	,
8869	,
8875	,
8880	,
8887	,
8829	,
8839	,
8851	,
8853	,
8855	,
8959	,
8912	,
8807	,
8798	,
8965	,
8810	,
8788	,
8904	,
8805	,
8799	,
8800	,
8802	,
8817	,
8859	,
8866	,
8868	,
8870	,
8837	,
8838	,
8902	,
8795	,
8929	,
8893	,
8945	,
8794	,
8796	,
8816	,
8861	,
8863	,
8886	,
8830	,
8835	,
8843	,
8844	,
8897	,
8891	,
8915	,
8943	,
8944	,
8908	,
8874	,
8949	,
8962	,
8966	,
8787	,
8916	,
8815	,
8895	,
8877	,
8840	,
8847	,
8850	,
8856	,
8806	,
8793	,
8924	,
8947	,
8808	,
8854	,
8876	,
8964	,
8803	,
8933	,
8860	,
8864	,
8872	,
8879	,
8881	,
8882	,
8831	,
8833	,
8846	,
8852	,
8857	,
8958	,
8890	,
8968	,
8804	,
8918	,
8925	,
8812	,
8826	,
8889	);